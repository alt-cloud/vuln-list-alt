{
  "Definition": [
    {
      "ID": "oval:org.altlinux.errata:def:20236074",
      "Version": "oval:org.altlinux.errata:def:20236074",
      "Class": "patch",
      "Metadata": {
        "Title": "ALT-PU-2023-6074: package `grub` update to version 2.06-alt16",
        "AffectedList": [
          {
            "Family": "unix",
            "Platforms": [
              "ALT Linux branch p10"
            ],
            "Products": [
              "ALT Server",
              "ALT Virtualization Server",
              "ALT Workstation",
              "ALT Workstation K",
              "ALT Education",
              "Simply Linux",
              "Starterkit"
            ]
          }
        ],
        "References": [
          {
            "RefID": "ALT-PU-2023-6074",
            "RefURL": "https://errata.altlinux.org/ALT-PU-2023-6074",
            "Source": "ALTPU"
          },
          {
            "RefID": "BDU:2022-03372",
            "RefURL": "https://bdu.fstec.ru/vul/2022-03372",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2022-06819",
            "RefURL": "https://bdu.fstec.ru/vul/2022-06819",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2022-06820",
            "RefURL": "https://bdu.fstec.ru/vul/2022-06820",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2022-06891",
            "RefURL": "https://bdu.fstec.ru/vul/2022-06891",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2022-06896",
            "RefURL": "https://bdu.fstec.ru/vul/2022-06896",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2023-00286",
            "RefURL": "https://bdu.fstec.ru/vul/2023-00286",
            "Source": "BDU"
          },
          {
            "RefID": "CVE-2021-3695",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2021-3695",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2021-3696",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2021-3696",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2021-3697",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2021-3697",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2022-2601",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2022-2601",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2022-28733",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2022-28733",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2022-28734",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2022-28734",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2022-28735",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2022-28735",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2022-28736",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2022-28736",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2022-3775",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2022-3775",
            "Source": "CVE"
          }
        ],
        "Description": "This update upgrades grub to version 2.06-alt16. \nSecurity Fix(es):\n\n * BDU:2022-03372: Уязвимость функции grub_net_recv_ip4_packets программы-загрузчика операционных систем Grub, позволяющая нарушителю выполнить произвольный код путем отправки специально сформированных IP-пакетов\n\n * BDU:2022-06819: Уязвимость функции grub_font_construct_glyph() загрузчика операционных систем Grub2, позволяющая нарушителю выполнить произвольный код\n\n * BDU:2022-06820: Уязвимость загрузчика операционных систем Grub2, связанная с выходом операции за границы буфера, позволяющая нарушителю выполнить произвольный код\n\n * BDU:2022-06891: Уязвимость конфигурационного файла Grub, связанная с записью за границами буфера, позволяющая нарушителю получить доступ к конфиденциальным данным, нарушить их целостность, а также вызвать отказ в обслуживании\n\n * BDU:2022-06896: Уязвимость конфигурационного файла Grub, позволяющая нарушителю получить доступ к конфиденциальным данным, нарушить их целостность, а также вызвать отказ в обслуживании\n\n * BDU:2023-00286: Уязвимость конфигурационного файла Grub, связанная с записью за границами буфера, позволяющая нарушителю получить доступ к конфиденциальным данным, нарушить их целостность, а также вызвать отказ в обслуживании\n\n * CVE-2021-3695: A crafted 16-bit grayscale PNG image may lead to a out-of-bounds write in the heap area. An attacker may take advantage of that to cause heap data corruption or eventually arbitrary code execution and circumvent secure boot protections. This issue has a high complexity to be exploited as an attacker needs to perform some triage over the heap layout to achieve signifcant results, also the values written into the memory are repeated three times in a row making difficult to produce valid payloads. This flaw affects grub2 versions prior grub-2.12.\n\n * CVE-2021-3696: A heap out-of-bounds write may heppen during the handling of Huffman tables in the PNG reader. This may lead to data corruption in the heap space. Confidentiality, Integrity and Availablity impact may be considered Low as it's very complex to an attacker control the encoding and positioning of corrupted Huffman entries to achieve results such as arbitrary code execution and/or secure boot circumvention. This flaw affects grub2 versions prior grub-2.12.\n\n * CVE-2021-3697: A crafted JPEG image may lead the JPEG reader to underflow its data pointer, allowing user-controlled data to be written in heap. To a successful to be performed the attacker needs to perform some triage over the heap layout and craft an image with a malicious format and payload. This vulnerability can lead to data corruption and eventual code execution or secure boot circumvention. This flaw affects grub2 versions prior grub-2.12.\n\n * CVE-2022-2601: A buffer overflow was found in grub_font_construct_glyph(). A malicious crafted pf2 font can lead to an overflow when calculating the max_glyph_size value, allocating a smaller than needed buffer for the glyph, this further leads to a buffer overflow and a heap based out-of-bounds write. An attacker may use this vulnerability to circumvent the secure boot mechanism.\n\n * CVE-2022-28733: Integer underflow in grub_net_recv_ip4_packets; A malicious crafted IP packet can lead to an integer underflow in grub_net_recv_ip4_packets() function on rsm-\u003etotal_len value. Under certain circumstances the total_len value may end up wrapping around to a small integer number which will be used in memory allocation. If the attack succeeds in such way, subsequent operations can write past the end of the buffer.\n\n * CVE-2022-28734: Out-of-bounds write when handling split HTTP headers; When handling split HTTP headers, GRUB2 HTTP code accidentally moves its internal data buffer point by one position. This can lead to a out-of-bound write further when parsing the HTTP request, writing a NULL byte past the buffer. It's conceivable that an attacker controlled set of packets can lead to corruption of the GRUB2's internal memory metadata.\n\n * CVE-2022-28735: The GRUB2's shim_lock verifier allows non-kernel files to be loaded on shim-powered secure boot systems. Allowing such files to be loaded may lead to unverified code and modules to be loaded in GRUB2 breaking the secure boot trust-chain.\n\n * CVE-2022-28736: There's a use-after-free vulnerability in grub_cmd_chainloader() function; The chainloader command is used to boot up operating systems that doesn't support multiboot and do not have direct support from GRUB2. When executing chainloader more than once a use-after-free vulnerability is triggered. If an attacker can control the GRUB2's memory allocation pattern sensitive data may be exposed and arbitrary code execution can be achieved.\n\n * CVE-2022-3775: When rendering certain unicode sequences, grub2's font code doesn't proper validate if the informed glyph's width and height is constrained within bitmap size. As consequence an attacker can craft an input which will lead to a out-of-bounds write into grub2's heap, leading to memory corruption and availability issues. Although complex, arbitrary code execution could not be discarded.\n\n * #43329: grub.filetrigger calls egrep(1)\n\n * #44387: Не убираются пункты меню recovery в GRUB2\n\n * #44406: GRUB_VMLINUZ_SYMLINKS default==yes\n\n * #45437: При установке в меню действий пункт \"Изменить язык\" написан на русском языке\n\n * #46660: Module efivars not found\n\n * #47244: В GRUB меню отсутствует выбор memtest86+ для UEFI\n\n * #47257: Добавить в grub efi image модули: f2fs, exfat, ntfs\n\n * #47471: Сломана генерация grub.cfg на i586, когда установлен memtest86+",
        "Advisory": {
          "From": "errata.altlinux.org",
          "Severity": "Critical",
          "Rights": "Copyright 2023 BaseALT Ltd.",
          "Issued": {
            "Date": "2023-10-17"
          },
          "Updated": {
            "Date": "2023-10-17"
          },
          "bdu": [
            {
              "Cvss": "AV:N/AC:H/Au:N/C:C/I:C/A:C",
              "Cvss3": "AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "Cwe": "CWE-191",
              "Href": "https://bdu.fstec.ru/vul/2022-03372",
              "Impact": "High",
              "Public": "20220607",
              "CveID": "BDU:2022-03372"
            },
            {
              "Cvss": "AV:L/AC:H/Au:S/C:C/I:C/A:C",
              "Cvss3": "AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H",
              "Cwe": "CWE-787",
              "Href": "https://bdu.fstec.ru/vul/2022-06819",
              "Impact": "Low",
              "Public": "20221116",
              "CveID": "BDU:2022-06819"
            },
            {
              "Cvss": "AV:L/AC:H/Au:S/C:N/I:C/A:C",
              "Cvss3": "AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:H",
              "Cwe": "CWE-787",
              "Href": "https://bdu.fstec.ru/vul/2022-06820",
              "Impact": "Low",
              "Public": "20221116",
              "CveID": "BDU:2022-06820"
            },
            {
              "Cvss": "AV:L/AC:M/Au:S/C:C/I:C/A:C",
              "Cvss3": "AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
              "Cwe": "CWE-787",
              "Href": "https://bdu.fstec.ru/vul/2022-06891",
              "Impact": "High",
              "Public": "20220706",
              "CveID": "BDU:2022-06891"
            },
            {
              "Cvss": "AV:L/AC:M/Au:S/C:C/I:C/A:C",
              "Cvss3": "AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L",
              "Cwe": "CWE-787",
              "Href": "https://bdu.fstec.ru/vul/2022-06896",
              "Impact": "Low",
              "Public": "20220706",
              "CveID": "BDU:2022-06896"
            },
            {
              "Cvss": "AV:L/AC:H/Au:S/C:P/I:P/A:P",
              "Cvss3": "AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L",
              "Cwe": "CWE-787",
              "Href": "https://bdu.fstec.ru/vul/2023-00286",
              "Impact": "Low",
              "Public": "20220706",
              "CveID": "BDU:2023-00286"
            }
          ],
          "Cves": [
            {
              "Cvss": "AV:L/AC:M/Au:N/C:P/I:P/A:P",
              "Cvss3": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L",
              "Cwe": "CWE-787",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2021-3695",
              "Impact": "Low",
              "Public": "20220706",
              "CveID": "CVE-2021-3695"
            },
            {
              "Cvss": "AV:L/AC:M/Au:N/C:C/I:C/A:C",
              "Cvss3": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L",
              "Cwe": "CWE-787",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2021-3696",
              "Impact": "Low",
              "Public": "20220706",
              "CveID": "CVE-2021-3696"
            },
            {
              "Cvss": "AV:L/AC:M/Au:N/C:P/I:P/A:P",
              "Cvss3": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
              "Cwe": "CWE-787",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2021-3697",
              "Impact": "High",
              "Public": "20220706",
              "CveID": "CVE-2021-3697"
            },
            {
              "Cvss3": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H",
              "Cwe": "CWE-122",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2022-2601",
              "Impact": "High",
              "Public": "20221214",
              "CveID": "CVE-2022-2601"
            },
            {
              "Cvss3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "Cwe": "CWE-191",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2022-28733",
              "Impact": "High",
              "Public": "20230720",
              "CveID": "CVE-2022-28733"
            },
            {
              "Cvss3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "Cwe": "CWE-787",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2022-28734",
              "Impact": "Critical",
              "Public": "20230720",
              "CveID": "CVE-2022-28734"
            },
            {
              "Cvss3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
              "Cwe": "NVD-CWE-noinfo",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2022-28735",
              "Impact": "High",
              "Public": "20230720",
              "CveID": "CVE-2022-28735"
            },
            {
              "Cvss3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
              "Cwe": "CWE-416",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2022-28736",
              "Impact": "High",
              "Public": "20230720",
              "CveID": "CVE-2022-28736"
            },
            {
              "Cvss3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H",
              "Cwe": "CWE-787",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2022-3775",
              "Impact": "High",
              "Public": "20221219",
              "CveID": "CVE-2022-3775"
            }
          ],
          "Bugzilla": [
            {
              "Id": "43329",
              "Href": "https://bugzilla.altlinux.org/43329",
              "Data": "grub.filetrigger calls egrep(1)"
            },
            {
              "Id": "44387",
              "Href": "https://bugzilla.altlinux.org/44387",
              "Data": "Не убираются пункты меню recovery в GRUB2"
            },
            {
              "Id": "44406",
              "Href": "https://bugzilla.altlinux.org/44406",
              "Data": "GRUB_VMLINUZ_SYMLINKS default==yes"
            },
            {
              "Id": "45437",
              "Href": "https://bugzilla.altlinux.org/45437",
              "Data": "При установке в меню действий пункт \"Изменить язык\" написан на русском языке"
            },
            {
              "Id": "46660",
              "Href": "https://bugzilla.altlinux.org/46660",
              "Data": "Module efivars not found"
            },
            {
              "Id": "47244",
              "Href": "https://bugzilla.altlinux.org/47244",
              "Data": "В GRUB меню отсутствует выбор memtest86+ для UEFI"
            },
            {
              "Id": "47257",
              "Href": "https://bugzilla.altlinux.org/47257",
              "Data": "Добавить в grub efi image модули: f2fs, exfat, ntfs"
            },
            {
              "Id": "47471",
              "Href": "https://bugzilla.altlinux.org/47471",
              "Data": "Сломана генерация grub.cfg на i586, когда установлен memtest86+"
            }
          ],
          "AffectedCpeList": {
            "Cpe": [
              "cpe:/o:alt:kworkstation:10",
              "cpe:/o:alt:workstation:10",
              "cpe:/o:alt:server:10",
              "cpe:/o:alt:server-v:10",
              "cpe:/o:alt:education:10",
              "cpe:/o:alt:slinux:10",
              "cpe:/o:alt:starterkit:p10",
              "cpe:/o:alt:kworkstation:10.1",
              "cpe:/o:alt:workstation:10.1",
              "cpe:/o:alt:server:10.1",
              "cpe:/o:alt:server-v:10.1",
              "cpe:/o:alt:education:10.1",
              "cpe:/o:alt:slinux:10.1",
              "cpe:/o:alt:starterkit:10.1",
              "cpe:/o:alt:kworkstation:10.2",
              "cpe:/o:alt:workstation:10.2",
              "cpe:/o:alt:server:10.2",
              "cpe:/o:alt:server-v:10.2",
              "cpe:/o:alt:education:10.2",
              "cpe:/o:alt:slinux:10.2",
              "cpe:/o:alt:starterkit:10.2"
            ]
          }
        }
      },
      "Criteria": {
        "Operator": "AND",
        "Criterions": [
          {
            "TestRef": "oval:org.altlinux.errata:tst:2001",
            "Comment": "ALT Linux must be installed"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterions": [
              {
                "TestRef": "oval:org.altlinux.errata:tst:20236074001",
                "Comment": "grub-common is earlier than 0:2.06-alt16"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20236074002",
                "Comment": "grub-efi is earlier than 0:2.06-alt16"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20236074003",
                "Comment": "grub-efi-checkinstall is earlier than 0:2.06-alt16"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20236074004",
                "Comment": "grub-ieee1275 is earlier than 0:2.06-alt16"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20236074005",
                "Comment": "grub-pc is earlier than 0:2.06-alt16"
              }
            ]
          }
        ]
      }
    }
  ]
}